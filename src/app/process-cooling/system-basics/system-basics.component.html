<div class="d-flex flex-column panel-container">
  <div class="header mr-2 ml-2">
    <h3>{{assessment.name}} Settings</h3>
    <br>
  </div>
  <div class="alert-warning mt-3 small mx-auto" *ngIf="showUpdateDataReminder">
    <div>Units of measure were changed after assessment data was entered.
      <br>Please update your assessment data for accurate results.
    </div>
    <a class="click-link" (click)="updateData(true)">Update Data</a>
  </div>
  <div class="alert-success mt-3 py-3 small mx-auto w-75 text-center" *ngIf="showSuccessMessage">
    <div>
      Data updated successfully!
    </div>
    <a class="click-link" (click)="dismissSuccessMessage()">Dismiss</a>
  </div>
  <app-application-settings [(settingsForm)]="settingsForm" (startSavePolling)="saveSettings()" [inPhast]="true"
    [inTreasureHunt]="true">
  </app-application-settings>

  <form class="pl-3 pr-3" #formRef [formGroup]="systemBasicsForm">
    <label class="group-label">System Settings</label>
    <div class="form-group">
      <label for="utilityType">Utility Type</label>
      <select class="form-control" name="utilityType" formControlName="utilityType" (change)="saveSystemBasics()"
        (focus)="focusField('utilityType')">
        <option [ngValue]="'Electricity'">Electricity</option>
      </select>
    </div>
    <div class="form-group">
      <label for="electricityCost">Electricity Cost</label>
      <div class="input-group">
        <input name="electricityCost" type="number" step="0.01" class="form-control" id="electricityCost"
          formControlName="electricityCost" (change)="saveSystemBasics()" (focus)="focusField('electricityCost')">
        <span class="units input-group-addon">$/kWh</span>
      </div>
      <span class="alert-danger pull-right small"
        *ngIf="systemBasicsForm.controls.electricityCost.invalid && !systemBasicsForm.controls.electricityCost.pristine">
        <span *ngIf="systemBasicsForm.controls.electricityCost.errors.required">Value Required</span>
        <span *ngIf="systemBasicsForm.controls.electricityCost.errors.min">Value can't be less than
          {{systemBasicsForm.controls.electricityCost.errors.min.min}} $/kWh.</span>
      </span>
    </div>
    <div class="form-group">
      <label for="fuelCost">Fuel Cost</label>
      <div class="input-group">
        <input name="fuelCost" type="number" step="0.01" class="form-control" id="fuelCost"
          formControlName="fuelCost" (change)="saveSystemBasics()" (focus)="focusField('fuelCost')">
        <span *ngIf="oldSettings.unitsOfMeasure === 'Imperial'" class="units input-group-addon">$/MMBtu</span>
        <span *ngIf="oldSettings.unitsOfMeasure !== 'Imperial'" class="units input-group-addon">$/GJ</span>
      </div>
      <span class="alert-danger pull-right small"
        *ngIf="systemBasicsForm.controls.fuelCost.invalid && !systemBasicsForm.controls.fuelCost.pristine">
        <span *ngIf="systemBasicsForm.controls.fuelCost.errors.required">Value Required</span>
        <span *ngIf="systemBasicsForm.controls.fuelCost.errors.min">Value can't be less than
          {{systemBasicsForm.controls.fuelCost.errors.min.min}} 
         <span *ngIf="oldSettings.unitsOfMeasure === 'Imperial'">$/MMBtu</span>
        <span *ngIf="oldSettings.unitsOfMeasure !== 'Imperial'">$/GJ</span>
        </span>
      </span>
    </div>
    <div class="form-group">
      <label for="location">Geographic Location</label>
      <div class="input-group">
        <input name="location" type="number" step="0.01" class="form-control" id="location"
          formControlName="location" (change)="saveSystemBasics()" (focus)="focusField('location')">
      </div>
      <span class="alert-danger pull-right small"
        *ngIf="systemBasicsForm.controls.location.invalid && !systemBasicsForm.controls.location.pristine">
        <span *ngIf="systemBasicsForm.controls.location.errors.required">Value Required</span>
      </span>
    </div>
    <!-- <div class="form-group">
      <label for="numberOfChillers">Number of Chillers</label>
      <div class="input-group">
        <input name="numberOfChillers" type="number" class="form-control" id="numberOfChillers"
          formControlName="numberOfChillers" (change)="saveSystemBasics()" (focus)="focusField('numberOfChillers')">
      </div>
      <span class="alert-danger pull-right small"
        *ngIf="systemBasicsForm.controls.numberOfChillers.invalid && !systemBasicsForm.controls.numberOfChillers.pristine">
        <span *ngIf="systemBasicsForm.controls.numberOfChillers.errors.required">Value Required</span>
        <span *ngIf="systemBasicsForm.controls.numberOfChillers.errors.min">Value can't be less than
          {{systemBasicsForm.controls.numberOfChillers.errors.min.min}} $/kWh.</span>
      </span>
    </div> -->
    <div class="form-group">
      <label for="waterSupplyTemperature">Chiller Water Supply Temperature</label>
      <div class="input-group">
        <input name="waterSupplyTemperature" type="number" class="form-control" id="waterSupplyTemperature"
          formControlName="waterSupplyTemperature" (change)="saveSystemBasics()" (focus)="focusField('waterSupplyTemperature')">
        <span *ngIf="oldSettings.unitsOfMeasure === 'Imperial'" class="input-group-addon units">&#8457;</span>
        <span *ngIf="oldSettings.unitsOfMeasure !== 'Imperial'" class="input-group-addon units">&#8451;</span>
      </div>
      <span class="alert-danger pull-right small"
        *ngIf="systemBasicsForm.controls.waterSupplyTemperature.invalid && !systemBasicsForm.controls.waterSupplyTemperature.pristine">
        <span *ngIf="systemBasicsForm.controls.waterSupplyTemperature.errors.required">Value Required</span>
        <span *ngIf="systemBasicsForm.controls.waterSupplyTemperature.errors.min">Value can't be less than
          {{systemBasicsForm.controls.waterSupplyTemperature.errors.min.min}} $/kWh.</span>
      </span>
    </div>

    <div class="form-group">
      <label for="condenserCoolingMethod">Condenser Cooling Method</label>
      <select class="form-control" name="condenserCoolingMethod" formControlName="condenserCoolingMethod" (change)="saveSystemBasics()"
        (focus)="focusField('condenserCoolingMethod')">
        <option [ngValue]="'air'">Air</option>
        <option [ngValue]="'water'">Water</option>
      </select>
    </div>
    <!--Equipment Notes-->
    <div class="form-group pt-4">
      <label class="group-label w-100">Equipment Notes</label>
      <textarea name="notes" rows="4" id="notes" (input)="saveSystemBasics()" formControlName="notes"
        placeholder="Add additional information for your equipment" (focus)="focusField('equipmentNotes')"
        class="w-100"></textarea>
    </div>
  </form>
</div>