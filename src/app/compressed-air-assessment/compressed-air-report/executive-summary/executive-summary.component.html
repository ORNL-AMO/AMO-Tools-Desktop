<div class="output-summary">
    <h4 class="show-print print-section-header">Assessment Executive Summary</h4>
    <table class="table table-hover table-striped">
        <thead>
            <tr>
                <th [ngStyle]="{'width.%': 100 /(combinedDayTypeResults.length+2)}"></th>
                <th [ngStyle]="{'width.%': 100 /(combinedDayTypeResults.length+2)}"
                    [ngClass]="{'selected-modification': selectedModificationIndex == -1}"></th>
                <th *ngFor="let mod of combinedDayTypeResults; let index = index;"
                    [ngStyle]="{'width.%': 100 /(numMods+2)}"
                    [ngClass]="{'selected-modification': index == selectedModificationIndex}">
                    <!-- <app-invalid-phast *ngIf="!mod.phast.valid.isValid" [phastValid]="mod.phast.valid"></app-invalid-phast> -->
                </th>
            </tr>
            <tr>
                <th [ngStyle]="{'width.%': 100 /(combinedDayTypeResults.length+2)}"></th>
                <th [ngStyle]="{'width.%': 100 /(combinedDayTypeResults.length+2)}"
                    [ngClass]="{'selected-modification': selectedModificationIndex == -1}">Baseline</th>
                <th *ngFor="let result of combinedDayTypeResults; let index = index;"
                    [ngStyle]="{'width.%': 100 /(combinedDayTypeResults.length+2)}"
                    [ngClass]="{'selected-modification': index == selectedModificationIndex}">
                    {{result.modification.name}}</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td class="percent-savings">Percent Savings (%)</td>
                <td [ngClass]="{'selected-modification': selectedModificationIndex == -1}">&mdash; &mdash;</td>
                <td *ngFor="let result of combinedDayTypeResults; let index = index;"
                    [ngClass]="{'selected-modification': index == selectedModificationIndex}">
                    <div class="hide-print" *ngIf="result.combinedResults.allSavingsResults.savings.percentSavings">
                        <app-percent-graph [value]="result.combinedResults.allSavingsResults.savings.percentSavings">
                        </app-percent-graph>
                    </div>
                    <div class="show-print text-center"
                        *ngIf="result.combinedResults.allSavingsResults.savings.percentSavings">
                        {{result.combinedResults.allSavingsResults.savings.percentSavings | number:'1.0'}} %
                    </div>
                    <div *ngIf="!result.combinedResults.allSavingsResults.savings.percentSavings">
                        &mdash; &mdash;
                    </div>
                </td>
            </tr>
            <tr *ngIf="displayAddReceiverVolume">
                <td>Add Receiver Volume Savings
                    <span> ($/yr)</span>
                </td>
                <td [ngClass]="{'selected-modification': selectedModificationIndex == -1}">
                    &mdash;</td>
                <td *ngFor="let result of combinedDayTypeResults; let index = index;"
                    [ngClass]="{'selected-modification': index == selectedModificationIndex}">
                    <span
                        *ngIf="result.combinedResults.addReceiverVolumeSavings.savings.power">{{result.combinedResults.addReceiverVolumeSavings.savings.power
                        | sigFigs:'5'}}</span>
                    <span *ngIf="!result.combinedResults.addReceiverVolumeSavings.savings.power">&mdash; &mdash;</span>
                </td>
            </tr>
            <tr *ngIf="displayAdjustCascadingSetPoints">
                <td>Adjust Cascading Set Points Savings
                    <span> ($/yr)</span>
                </td>
                <td [ngClass]="{'selected-modification': selectedModificationIndex == -1}">
                    &mdash;</td>
                <td *ngFor="let result of combinedDayTypeResults; let index = index;"
                    [ngClass]="{'selected-modification': index == selectedModificationIndex}">
                    <span
                        *ngIf="result.combinedResults.adjustCascadingSetPointsSavings.savings.power">{{result.combinedResults.adjustCascadingSetPointsSavings.savings.power
                        | sigFigs:'5'}}</span>
                    <span *ngIf="!result.combinedResults.adjustCascadingSetPointsSavings.savings.power">&mdash; &mdash;</span>
                </td>
            </tr>
            <tr *ngIf="displayImproveEndUseEfficiency">
                <td>Improve End Use Efficiency Savings
                    <span> ($/yr)</span>
                </td>
                <td [ngClass]="{'selected-modification': selectedModificationIndex == -1}">
                    &mdash;</td>
                <td *ngFor="let result of combinedDayTypeResults; let index = index;"
                    [ngClass]="{'selected-modification': index == selectedModificationIndex}">
                    <span
                        *ngIf="result.combinedResults.improveEndUseEfficiencySavings.savings.power">{{result.combinedResults.improveEndUseEfficiencySavings.savings.power
                        | sigFigs:'5'}}</span>
                    <span *ngIf="!result.combinedResults.improveEndUseEfficiencySavings.savings.power">&mdash; &mdash;</span>
                </td>
            </tr>
            <tr *ngIf="displayReduceAirLeaks">
                <td>Reduce Air Leaks Savings
                    <span> ($/yr)</span>
                </td>
                <td [ngClass]="{'selected-modification': selectedModificationIndex == -1}">
                    &mdash;</td>
                <td *ngFor="let result of combinedDayTypeResults; let index = index;"
                    [ngClass]="{'selected-modification': index == selectedModificationIndex}">
                    <span
                        *ngIf="result.combinedResults.reduceAirLeaksSavings.savings.power">{{result.combinedResults.reduceAirLeaksSavings.savings.power
                        | sigFigs:'5'}}</span>
                    <span *ngIf="!result.combinedResults.reduceAirLeaksSavings.savings.power">&mdash; &mdash;</span>
                </td>
            </tr>
            <tr *ngIf="displayReduceRuntime">
                <td>Reduce Runtime Savings
                    <span> ($/yr)</span>
                </td>
                <td [ngClass]="{'selected-modification': selectedModificationIndex == -1}">
                    &mdash;</td>
                <td *ngFor="let result of combinedDayTypeResults; let index = index;"
                    [ngClass]="{'selected-modification': index == selectedModificationIndex}">
                    <span
                        *ngIf="result.combinedResults.reduceRunTimeSavings.savings.power">{{result.combinedResults.reduceRunTimeSavings.savings.power
                        | sigFigs:'5'}}</span>
                    <span *ngIf="!result.combinedResults.reduceRunTimeSavings.savings.power">&mdash; &mdash;</span>
                </td>
            </tr>
            <tr *ngIf="displayReduceSystemPressure">
                <td>Reduce System Air Pressure Savings
                    <span> ($/yr)</span>
                </td>
                <td [ngClass]="{'selected-modification': selectedModificationIndex == -1}">
                    &mdash;</td>
                <td *ngFor="let result of combinedDayTypeResults; let index = index;"
                    [ngClass]="{'selected-modification': index == selectedModificationIndex}">
                    <span
                        *ngIf="result.combinedResults.reduceSystemAirPressureSavings.savings.power">{{result.combinedResults.reduceSystemAirPressureSavings.savings.power
                        | sigFigs:'5'}}</span>
                    <span *ngIf="!result.combinedResults.reduceSystemAirPressureSavings.savings.power">&mdash; &mdash;</span>
                </td>
            </tr>
            <tr *ngIf="displayUseAutomaticSequencer">
                <td>Use Automatic Sequencer Savings
                    <span> ($/yr)</span>
                </td>
                <td [ngClass]="{'selected-modification': selectedModificationIndex == -1}">
                    &mdash;</td>
                <td *ngFor="let result of combinedDayTypeResults; let index = index;"
                    [ngClass]="{'selected-modification': index == selectedModificationIndex}">
                    <span
                        *ngIf="result.combinedResults.useAutomaticSequencerSavings.savings.power">{{result.combinedResults.useAutomaticSequencerSavings.savings.power
                        | sigFigs:'5'}}</span>
                    <span *ngIf="!result.combinedResults.useAutomaticSequencerSavings.savings.power">&mdash; &mdash;</span>
                </td>
            </tr>
            <tr *ngIf="displayAuxiliaryPower">
                <td>Auxiliary Power Cost
                    <span> ($/yr)</span>
                </td>
                <td [ngClass]="{'selected-modification': selectedModificationIndex == -1}">
                    &mdash;</td>
                <td *ngFor="let result of combinedDayTypeResults; let index = index;"
                    [ngClass]="{'selected-modification': index == selectedModificationIndex}">
                    <span
                        *ngIf="result.combinedResults.auxiliaryPowerUsage.cost">{{result.combinedResults.auxiliaryPowerUsage.cost * -1 
                        | sigFigs:'5'}}</span>
                    <span *ngIf="!result.combinedResults.auxiliaryPowerUsage.cost">&mdash; &mdash;</span>
                </td>
            </tr>
            <tr *ngIf="displayAuxiliaryPower">
                <td>Auxiliary Power Energy Use
                    <span> (kWh)</span>
                </td>
                <td [ngClass]="{'selected-modification': selectedModificationIndex == -1}">
                    &mdash;</td>
                <td *ngFor="let result of combinedDayTypeResults; let index = index;"
                    [ngClass]="{'selected-modification': index == selectedModificationIndex}">
                    <span
                        *ngIf="result.combinedResults.auxiliaryPowerUsage.energyUse">{{result.combinedResults.auxiliaryPowerUsage.energyUse
                        | sigFigs:'5'}}</span>
                    <span *ngIf="!result.combinedResults.auxiliaryPowerUsage.energyUse">&mdash; &mdash;</span>
                </td>
            </tr>
            <tr class="bold-row">
                <td>Annual Energy Used
                    <span> (kWh/yr)</span>
                </td>
                <td [ngClass]="{'selected-modification': selectedModificationIndex == -1}">
                    {{baselineResults.total.energyUse | sigFigs:'5'}}</td>
                <td *ngFor="let result of combinedDayTypeResults; let index = index;"
                    [ngClass]="{'selected-modification': index == selectedModificationIndex}">
                    <span
                        *ngIf="result.combinedResults.allSavingsResults.adjustedResults.power">{{result.combinedResults.allSavingsResults.adjustedResults.power
                        | sigFigs:'5'}}</span>
                    <span *ngIf="!result.combinedResults.allSavingsResults.adjustedResults.power">&mdash; &mdash;</span>
                </td>
            </tr>
            <tr class="bold-row">
                <td>Annual Energy Savings
                    <span> (kWh/yr)</span>
                </td>
                <td [ngClass]="{'selected-modification': selectedModificationIndex == -1}">&mdash; &mdash;</td>
                <td *ngFor="let result of combinedDayTypeResults; let index = index;"
                    [ngClass]="{'selected-modification': index == selectedModificationIndex}">
                    <span
                        *ngIf="result.combinedResults.allSavingsResults.savings.power">{{result.combinedResults.allSavingsResults.savings.power
                        |
                        sigFigs:'5'}}</span>
                    <span *ngIf="!result.combinedResults.allSavingsResults.savings.power">&mdash; &mdash;</span>
                </td>
            </tr>
            <tr class="bold-row">
                <td>Annual Cost
                    <span> ($/yr)</span>
                </td>
                <td [ngClass]="{'selected-modification': selectedModificationIndex == -1}">
                    {{baselineResults.total.cost | sigFigs:'5'}}</td>
                <td *ngFor="let result of combinedDayTypeResults; let index = index;"
                    [ngClass]="{'selected-modification': index == selectedModificationIndex}">
                    <span
                        *ngIf="result.combinedResults.allSavingsResults.adjustedResults.cost">{{result.combinedResults.allSavingsResults.adjustedResults.cost
                        | sigFigs:'5'}}</span>
                    <span *ngIf="!result.combinedResults.allSavingsResults.adjustedResults.cost">&mdash; &mdash;</span>
                </td>
            </tr>
            <tr class="bold-row">
                <td>Annual Cost Savings
                    <span> ($/yr)</span>
                </td>
                <td [ngClass]="{'selected-modification': selectedModificationIndex == -1}">&mdash; &mdash;</td>
                <td *ngFor="let result of combinedDayTypeResults; let index = index;"
                    [ngClass]="{'selected-modification': index == selectedModificationIndex}">
                    <span
                        *ngIf="result.combinedResults.allSavingsResults.savings.cost">{{result.combinedResults.allSavingsResults.savings.cost
                        |
                        sigFigs:'5'}}</span>
                    <span *ngIf="!result.combinedResults.allSavingsResults.savings.cost">&mdash; &mdash;</span>
                </td>
            </tr>
            <!-- <tr>
                <td>
                    Implementation Costs
                </td>
            </tr>
            <tr>
                <td>
                 Simple Payback Period
                </td>
            </tr> -->
            <tr>
                <td>
                    Demand Side Energy Projects
                </td>
                <td [ngClass]="{'selected-modification': selectedModificationIndex == -1}">
                    &mdash;
                </td>
                <td *ngFor="let result of combinedDayTypeResults; let index = index;"
                    [ngClass]="{'selected-modification': index == selectedModificationIndex}">
                   <span [innerHTML]="getDemandEnergyProjects(result.modification)"></span>
                </td>
            </tr>
            <tr>
                <td>
                    Supply Side Energy Projects
                </td>
                <td [ngClass]="{'selected-modification': selectedModificationIndex == -1}">
                    &mdash;
                </td>
                <td *ngFor="let result of combinedDayTypeResults; let index = index;"
                    [ngClass]="{'selected-modification': index == selectedModificationIndex}">
                    <span [innerHTML]="getSupplyEnergyProjects(result.modification)"></span>
                </td>
            </tr>
        </tbody>
    </table>
</div>