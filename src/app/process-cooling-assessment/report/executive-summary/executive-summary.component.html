<div class="output-summary p-3">
    <h4 class="show-print print-section-header">Executive Summary</h4>
    <table #copyTable class="table table-hover">
        <thead>
            <tr>
                @let modificationNames = modificationNames$ | async;
                
                <th [style.width.%]="100 /(modificationNames.length+2)"></th>
                <th [style.width.%]="100 /(modificationNames.length+2)">Baseline</th>
                @for (modificationName of modificationNames; track modificationName; let modIndex = $index) {
                    <th [style.width.%]="100 /(modificationNames.length+2)">
                        {{modificationName}}</th>
                }

            </tr>
        </thead>
        <tbody>
            <!-- todo  Percent Savings Graph row (this component only) -->
            <tr class="bg-row">
                <td class="percent-savings">Percent Savings (%)</td>
                <td>&mdash; &mdash;</td>
                @for (modificationNames of modificationNames$ | async; track modificationNames; let modIndex = $index) {
                    <td class="percent-savings">Percent Savings (%)</td>
                }   
            </tr>

            @if (executiveSummaryRows$ | async; as executiveSummaryRows) {
                @for (row of executiveSummaryRows; track row) {
                    <tr [class.bold-row]="row.rowType === 'bold' || row.rowType === 'bold-bg' || row.rowType === 'bold-row-stripe'"
                        [class.bg-row]="row.rowType === 'bold-bg' || row.rowType === 'bold-row-stripe'"
                        [class.row-stripe]="row.rowType === 'bold-row-stripe'" 
                        [class.hide-print]="row.rowType === 'hide-print'">
                        <td [innerHTML]="row.label"></td>
                        <td>
                            @if (row.baseline.numberPipe && row.baseline.value !== null && row.baseline.value !== undefined) {
                                {{ row.baseline.value | number: row.baseline.numberPipe }}
                            } @else {
                                {{ row.baseline.value ?? '— —' }}
                            }
                        </td>
                        @for (modResult of row.modifications; track modResult.id; let modificationIndex = $index) {
                            <td>
                                @if (modResult.numberPipe && modResult.value !== null && modResult.value !== undefined) {
                                {{ modResult.value | number: modResult.numberPipe }}
                                } @else {
                                {{ modResult.value ?? '— —' }}
                                }
                            </td>
                        }
                    </tr>
                }
            }

            <tr>
                <td>Energy Efficiency Measures used</td>
                <td>&mdash; &mdash;</td>
                
                @for(modificationEEMs of modificationEEMsUsedSignal(); track modificationEEMs.modificationId; let modEEMsIndex = $index) {
                <td>
                    @if (modificationEEMs.eemsUsed.length > 0) {
                        @for (eem of modificationEEMs.eemsUsed; track eem) {
                            {{eem}} <br>
                        }
                    } @else {
                        {{ '— —' }}
                    }
                </td>
                }
            </tr>

        </tbody>
    </table>

</div>

<app-exportable-results-table [tableString]="copyTableString"
    (updateTableString)="updateCopyTableString()"></app-exportable-results-table>