<div class="output-summary">

  <h4 class="show-print">Report Results</h4>

  <table class="table table-striped table-hover">
    <thead>
      <tr>
        <th [ngStyle]="{'width.%': 100 /(fsat.modifications.length+2)}"></th>
        <th [ngStyle]="{'width.%': 100 /(fsat.modifications.length+2)}"
          [ngClass]="{'selected-modification': selectedModificationIndex == -1}">Baseline</th>
        <th [ngStyle]="{'width.%': 100 /(fsat.modifications.length+2)}"
          *ngFor="let modification of fsat.modifications; let index = index;"
          [ngClass]="{'selected-modification': index == selectedModificationIndex}">{{modification.fsat.name}}</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>Percent Savings (%)</td>
        <td [ngClass]="{'selected-modification': selectedModificationIndex == -1}">
          &mdash; &mdash;
        </td>
        <td class="percent-graph" *ngFor="let modification of fsat.modifications; let index = index;"
          [ngClass]="{'selected-modification': index == selectedModificationIndex}">
          <div class="hide-print" *ngIf="modification.fsat.outputs.percentSavings">
            <app-percent-graph *ngIf="modification.fsat.valid.isValid"
              [value]="modification.fsat.outputs.percentSavings"></app-percent-graph>
            <div class="alert-danger small" *ngIf="!modification.fsat.valid.isValid">
              Invalid modification<br>
              <span *ngIf="!modification.fsat.valid.fluidValid">Errors found in Fluid<br></span>
              <span *ngIf="!modification.fsat.valid.fieldDataValid">Errors found in Field Data<br></span>
              <span *ngIf="!modification.fsat.valid.fanValid">Errors found in Fan Setup<br></span>
              <span *ngIf="!modification.fsat.valid.motorValid">Errors found in Motor<br></span>
            </div>
          </div>
          <div class="show-print text-center" *ngIf="modification.fsat.outputs.percentSavings">
            {{modification.fsat.outputs.percentSavings | number:'1.0'}} %
          </div>
          <div *ngIf="!modification.fsat.outputs.percentSavings" class="mx-auto">&mdash; &mdash;</div>
        </td>
      </tr>
      <tr>
        <td>Fan Energy Index</td>
        <td [ngClass]="{'selected-modification': selectedModificationIndex == -1}">
          {{fsat.outputs.fanEnergyIndex | number:'1.0-2'}}</td>
        <td *ngFor="let modification of fsat.modifications; let index = index;"
          [ngClass]="{'selected-modification': index == selectedModificationIndex}">
          {{modification.fsat.outputs.fanEnergyIndex | number:'1.0-2'}}</td>
      </tr>
      <tr>
        <td>Fan efficiency (%)</td>
        <td [ngClass]="{'selected-modification': selectedModificationIndex == -1}">
          {{fsat.outputs.fanEfficiency | number:'1.0-1'}}</td>
        <td *ngFor="let modification of fsat.modifications; let index = index;"
          [ngClass]="{'selected-modification': index == selectedModificationIndex}">{{modification.fsat.outputs.fanEfficiency
          | number:'1.0-1'}}</td>
      </tr>
      <tr>
        <td>Motor rated power ({{settings.fanPowerMeasurement}})</td>
        <td [ngClass]="{'selected-modification': selectedModificationIndex == -1}">
          {{fsat.outputs.motorRatedPower | number:'1.0-0'}}</td>
        <td *ngFor="let modification of fsat.modifications; let index = index;"
          [ngClass]="{'selected-modification': index == selectedModificationIndex}">{{modification.fsat.outputs.motorRatedPower
          | number:'2.0-0'}}</td>
      </tr>
      <tr>
        <td>Motor shaft power ({{settings.fanPowerMeasurement}})</td>
        <td [ngClass]="{'selected-modification': selectedModificationIndex == -1}">
          {{fsat.outputs.motorShaftPower | number:'1.0-1'}}</td>
        <td *ngFor="let modification of fsat.modifications; let index = index;"
          [ngClass]="{'selected-modification': index == selectedModificationIndex}">{{modification.fsat.outputs.motorShaftPower
          | number:'1.0-1'}}</td>
      </tr>
      <tr>
        <td>Fan shaft power ({{settings.fanPowerMeasurement}})</td>
        <td [ngClass]="{'selected-modification': selectedModificationIndex == -1}">
          {{fsat.outputs.fanShaftPower | number:'1.0-1'}}</td>
        <td *ngFor="let modification of fsat.modifications; let index = index;"
          [ngClass]="{'selected-modification': index == selectedModificationIndex}">{{modification.fsat.outputs.fanShaftPower
          | number:'1.0-1'}}</td>
      </tr>
      <tr>
        <td>Motor efficiency (%)</td>
        <td [ngClass]="{'selected-modification': selectedModificationIndex == -1}">
          {{fsat.outputs.motorEfficiency | number:'1.0-1'}}</td>
        <td *ngFor="let modification of fsat.modifications; let index = index;"
          [ngClass]="{'selected-modification': index == selectedModificationIndex}">{{modification.fsat.outputs.motorEfficiency
          | number:'1.0-1'}}</td>
      </tr>
      <tr>
        <td>Motor power factor (%)</td>
        <td [ngClass]="{'selected-modification': selectedModificationIndex == -1}">
          {{fsat.outputs.motorPowerFactor | number:'1.0-1'}}</td>
        <td *ngFor="let modification of fsat.modifications; let index = index;"
          [ngClass]="{'selected-modification': index == selectedModificationIndex}">{{modification.fsat.outputs.motorPowerFactor
          | number:'1.0-1'}}</td>
      </tr>
      <tr>
        <td>Percent Loaded (%)</td>
        <td [ngClass]="{'selected-modification': selectedModificationIndex == -1}">
          {{fsat.outputs.loadFactor*100 | number:'1.0-1'}}</td>
        <td *ngFor="let modification of fsat.modifications; let index = index;"
          [ngClass]="{'selected-modification': index == selectedModificationIndex}">{{modification.fsat.outputs.loadFactor*100
          | number:'1.0-1'}}</td>
      </tr>
      <tr>
        <td>Drive efficiency (%)</td>
        <td [ngClass]="{'selected-modification': selectedModificationIndex == -1}">
          {{fsat.outputs.driveEfficiency | number:'1.0-1'}}</td>
        <td *ngFor="let modification of fsat.modifications; let index = index;"
          [ngClass]="{'selected-modification': index == selectedModificationIndex}">{{modification.fsat.outputs.driveEfficiency
          | number:'1.0-1'}}</td>
      </tr>
      <tr>
        <td>Motor current (amps)</td>
        <td [ngClass]="{'selected-modification': selectedModificationIndex == -1}">
          {{fsat.outputs.motorCurrent | number:'1.0-0'}}</td>
        <td *ngFor="let modification of fsat.modifications; let index = index;"
          [ngClass]="{'selected-modification': index == selectedModificationIndex}">{{modification.fsat.outputs.motorCurrent
          | number:'1.0-0'}}</td>
      </tr>
      <tr>
        <td>Motor power (kW)</td>
        <td [ngClass]="{'selected-modification': selectedModificationIndex == -1}">
          {{fsat.outputs.motorPower | number:'1.0-1'}}</td>
        <td *ngFor="let modification of fsat.modifications; let index = index;"
          [ngClass]="{'selected-modification': index == selectedModificationIndex}">{{modification.fsat.outputs.motorPower
          | number:'1.0-1'}}</td>
      </tr>
      <tr>
        <th>Annual Energy (MWh)</th>
        <th [ngClass]="{'selected-modification': selectedModificationIndex == -1}">
          {{fsat.outputs.annualEnergy | number:'1.0-0'}}</th>
        <th *ngFor="let modification of fsat.modifications; let index = index;"
          [ngClass]="{'selected-modification': index == selectedModificationIndex}">{{modification.fsat.outputs.annualEnergy
          | number:'1.0-0'}}</th>
      </tr>
      <tr>
        <th>Annual Energy Savings (MWh)</th>
        <th [ngClass]="{'selected-modification': selectedModificationIndex == -1}">&mdash;</th>
        <th *ngFor="let modification of fsat.modifications; let index = index;"
          [ngClass]="{'positive-savings': modification.fsat.outputs.percentSavings > 10, 'selected-modification': index == selectedModificationIndex}">{{modification.fsat.outputs.energySavings
          | number:'1.0-0'}}</th>
      </tr>
      <tr>
        <th>Annual Cost ({{settings.currency}})</th>
        <th [ngClass]="{'selected-modification': selectedModificationIndex == -1}">
          {{fsat.outputs.annualCost}}</th>
        <th *ngFor="let modification of fsat.modifications; let index = index;"
          [ngClass]="{'positive-savings': modification.fsat.outputs.percentSavings > 10,'selected-modification': index == selectedModificationIndex}">{{modification.fsat.outputs.annualCost}}</th>
      </tr>
      <tr>
        <th>Annual Savings ({{settings.currency}})</th>
        <th [ngClass]="{'selected-modification': selectedModificationIndex == -1}">&mdash;</th>
        <th *ngFor="let modification of fsat.modifications; let index = index;"
          [ngClass]="{'positive-savings': modification.fsat.outputs.percentSavings > 10, 'selected-modification': index == selectedModificationIndex}">
          {{modification.fsat.outputs.annualSavings}}
        </th>
      </tr>
      <!--  -->
      <tr>
        <th>Selected Energy Projects</th>
        <th [ngClass]="{'selected-modification': selectedModificationIndex == -1}">&mdash;</th>
        <th *ngFor="let modification of fsat.modifications; let index = index;"
          [ngClass]="{'selected-modification': index == selectedModificationIndex}">
          <span class="d-block"
            *ngIf="modification.exploreOppsShowVfd && modification.exploreOppsShowVfd.hasOpportunity">{{ modification.exploreOppsShowVfd.display }}</span>
          <span class="d-block"
            *ngIf="modification.exploreOppsShowDrive && modification.exploreOppsShowDrive.hasOpportunity && !modification.exploreOppsShowVfd.hasOpportunity">{{ modification.exploreOppsShowDrive.display }}</span>
          <span class="d-block"
            *ngIf="modification.exploreOppsShowFanType && modification.exploreOppsShowFanType.hasOpportunity && !modification.exploreOppsShowVfd.hasOpportunity">{{ modification.exploreOppsShowFanType.display }}</span>
          <span class="d-block"
            *ngIf="modification.exploreOppsShowMotor && modification.exploreOppsShowMotor.hasOpportunity">{{ modification.exploreOppsShowMotor.display }}</span>
          <span class="d-block"
            *ngIf="modification.exploreOppsShowFlowRate && modification.exploreOppsShowFlowRate.hasOpportunity">{{ modification.exploreOppsShowFlowRate.display }}</span>
          <span class="d-block"
            *ngIf="modification.exploreOppsShowReducePressure && modification.exploreOppsShowReducePressure.hasOpportunity">{{ modification.exploreOppsShowReducePressure.display }}</span>
          <span class="d-block"
            *ngIf="modification.exploreOppsShowOpData && modification.exploreOppsShowOpData.hasOpportunity">{{ modification.exploreOppsShowOpData.display }}</span>
        </th>
      </tr>
      <tr>
        <th>Modifications</th>
        <th [ngClass]="{'selected-modification': selectedModificationIndex == -1}">&mdash;</th>
        <th *ngFor="let modification of fsat.modifications; let index = index;"
          [ngClass]="{'selected-modification': index == selectedModificationIndex}">
          <div *ngFor="let modificationMade of getModificationsMadeList(modification.fsat)">
            {{modificationMade}}<br>
          </div>
        </th>
      </tr>
      <tr>
        <td></td>
        <td [ngClass]="{'selected-modification': selectedModificationIndex == -1}"></td>
        <td *ngFor="let modification of fsat.modifications; let index = index;"
          [ngClass]="{'selected-modification': index == selectedModificationIndex}">
          <span *ngIf="modification.fsat.fanSetup.fanType != 12" class="text-muted">*Optimized</span>
        </td>
      </tr>
      <tr class="hide-print" *ngIf="inRollup">
        <td>Use for Summary</td>
        <td [ngClass]="{'selected-modification': selectedModificationIndex == -1}">
          <input name="{{'summarySelect_'+assessment.id}}" type="radio" (change)="useModification()" [value]="-1"
            [(ngModel)]="selectedModificationIndex">
        </td>
        <td *ngFor="let modification of fsat.modifications; let index = index;"
          [ngClass]="{'selected-modification': index == selectedModificationIndex}">
          <input name="{{'summarySelect_'+assessment.id}}" type="radio" (change)="useModification()" [value]="index"
            [(ngModel)]="selectedModificationIndex">
        </td>
      </tr>
    </tbody>
  </table>
</div>