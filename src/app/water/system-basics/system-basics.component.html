<div class="d-flex flex-column panel-container">
  <div class="header mr-2 ml-2">
    <h3>{{assessment.name}} Settings</h3>
    <br>
  </div>
  <div class="alert-warning mt-3 small mx-auto" *ngIf="showUpdateDataReminder">
    <div>Units of measure were changed after assessment data was entered.
      <br>Please update your assessment data for accurate results.
    </div>
    <a class="click-link" (click)="updateData(true)">Update Data</a>
  </div>
  <div class="alert-success mt-3 py-3 small mx-auto w-75 text-center" *ngIf="showSuccessMessage">
    <div>
      Data updated successfully!
    </div>
    <a class="click-link" (click)="dismissSuccessMessage()">Dismiss</a>
  </div>
  <app-application-settings [(settingsForm)]="settingsForm" [inPhast]="true" [inTreasureHunt]="true"
    (startSavePolling)="saveSettings()">
  </app-application-settings>

  <form [formGroup]="systemBasicsForm">
    <label class="group-label">Modeling Conditions</label>

    <div class="form-group">
      <label for="utilityType">Utility Type</label>
      <select class="form-control" name="utilityType" formControlName="utilityType" (change)="saveSystemBasics()"
        (focus)="focusField('utilityType')">
        <option [ngValue]="'Electricity'">Electricity</option>
      </select>
    </div>

    <div class="form-group">
      <label for="electricityCost">Electricity Cost</label>
      <div class="input-group">
        <input name="electricityCost" type="number" step="0.01" class="form-control" id="electricityCost"
          formControlName="electricityCost" (change)="saveSystemBasics()" (focus)="focusField('electricityCost')">
        <span class="units input-group-addon">$/kWh</span>
      </div>
      <span class="alert-danger pull-right small"
        *ngIf="systemBasicsForm.controls.electricityCost.invalid && !systemBasicsForm.controls.electricityCost.pristine">
        <span *ngIf="systemBasicsForm.controls.electricityCost.errors.required">Value Required</span>
        <span *ngIf="systemBasicsForm.controls.electricityCost.errors.min">Value can't be less than
          {{systemBasicsForm.controls.electricityCost.errors.min.min}} $/kWh.</span>
      </span>
    </div>
  </form>

  <div class="mx-2 pt-3">
    <label class="group-label" (click)="toggleCollapse('waterTreatment')">
      <span class="fa fa-chevron-right"
        [ngClass]="{'fa-chevron-right': isCollapsed.waterTreatment, 'fa-chevron-down': !isCollapsed.waterTreatment}"></span>
      Water Treatment
    </label>

    <ng-container *ngIf="!isCollapsed.waterTreatment">
      <app-water-treatment-wrapper [waterAssessment]="assessment.water" [inSystemBasics]="true"></app-water-treatment-wrapper>
    </ng-container>
  </div>

  <div class="mx-2 pt-3">
    <label class="group-label" (click)="toggleCollapse('wasteWaterTreatment')">
      <span class="fa fa-chevron-right"
        [ngClass]="{'fa-chevron-right': isCollapsed.wasteWaterTreatment, 'fa-chevron-down': !isCollapsed.wasteWaterTreatment}"></span>
      Waste Water Treatment
    </label>

    <ng-container *ngIf="!isCollapsed.wasteWaterTreatment">
      <app-waste-water-treatment-wrapper [waterAssessment]="assessment.water" [inSystemBasics]="true"></app-waste-water-treatment-wrapper>
    </ng-container>
  </div>

  <form [formGroup]="systemBasicsForm">
    <div class="form-group pt-4">
      <label class="group-label w-100">Equipment Notes</label>
      <textarea name="notes" rows="4" id="notes" (input)="saveSystemBasics()" formControlName="notes"
        placeholder="Add additional information for your equipment" (focus)="focusField('equipmentNotes')"
        class="w-100"></textarea>
    </div>
  </form>
</div>
