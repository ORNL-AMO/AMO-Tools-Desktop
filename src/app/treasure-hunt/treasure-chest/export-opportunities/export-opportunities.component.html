<div bsModal #exportModal="bs-modal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="exportModalLabel"
    aria-hidden="true" [config]="{backdrop: 'static'}">
    <div class="modal-dialog modal-lg export-modal">
        <div class="modal-content">
            <div class="modal-header">
                Data to be exported
                <button class="close" aria-label="Close" (click)="hideExportModal()">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body pb-0 scroll-item">
                <div class="row no-gutters">
                    <div class="col-6 p-2" *ngIf="exportOpportunities.lightingReplacements">
                        <label>Lighting Replacements</label>
                        <ul>
                            <li
                                *ngFor="let replacement of exportOpportunities.lightingReplacements; let index = index;">
                                <span *ngIf="!replacement.opportunitySheet || !replacement.opportunitySheet.name">
                                    Lighting Replacement #{{index+1}}
                                </span>
                                <span *ngIf="replacement.opportunitySheet && replacement.opportunitySheet.name">
                                    {{replacement.opportunitySheet.name}}
                                </span>
                            </li>
                        </ul>
                    </div>
                    <div class="col-6 p-2" *ngIf="exportOpportunities.replaceExistingMotors">
                        <label>Motor Replacements</label>
                        <ul>
                            <li
                                *ngFor="let replaceExistingMotor of exportOpportunities.replaceExistingMotors; let index = index;">
                                <span
                                    *ngIf="!replaceExistingMotor.opportunitySheet || !replaceExistingMotor.opportunitySheet.name">
                                    Replace Motor #{{index+1}}
                                </span>
                                <span
                                    *ngIf="replaceExistingMotor.opportunitySheet && replaceExistingMotor.opportunitySheet.name">
                                    {{replaceExistingMotor.opportunitySheet.name}}
                                </span>
                            </li>
                        </ul>
                    </div>
                    <div class="col-6 p-2" *ngIf="exportOpportunities.motorDrives">
                        <label>Upgrade Motor Drives</label>
                        <ul>
                            <li *ngFor="let motorDrive of exportOpportunities.motorDrives; let index = index;">
                                <span *ngIf="!motorDrive.opportunitySheet || !motorDrive.opportunitySheet.name">
                                    Motor Drive #{{index+1}}
                                </span>
                                <span *ngIf="motorDrive.opportunitySheet && motorDrive.opportunitySheet.name">
                                    {{motorDrive.opportunitySheet.name}}
                                </span>
                            </li>
                        </ul>
                    </div>
                    <div class="col-6 p-2" *ngIf="exportOpportunities.naturalGasReductions">
                        <label>Natural Gas Reductions</label>
                        <ul>
                            <li
                                *ngFor="let naturalGasReduction of exportOpportunities.naturalGasReductions; let index = index;">
                                <span
                                    *ngIf="!naturalGasReduction.opportunitySheet || !naturalGasReduction.opportunitySheet.name">
                                    Natural Gas Reduction #{{index+1}}
                                </span>
                                <span
                                    *ngIf="naturalGasReduction.opportunitySheet && naturalGasReduction.opportunitySheet.name">
                                    {{naturalGasReduction.opportunitySheet.name}}
                                </span>
                            </li>
                        </ul>
                    </div>
                    <div class="col-6 p-2" *ngIf="exportOpportunities.electricityReductions">
                        <label>Electricity Reductions</label>
                        <ul>
                            <li
                                *ngFor="let electricityReduction of exportOpportunities.electricityReductions; let index = index;">
                                <span
                                    *ngIf="!electricityReduction.opportunitySheet || !electricityReduction.opportunitySheet.name">
                                    Electricity Reduction #{{index+1}}
                                </span>
                                <span
                                    *ngIf="electricityReduction.opportunitySheet && electricityReduction.opportunitySheet.name">
                                    {{electricityReduction.opportunitySheet.name}}
                                </span>
                            </li>
                        </ul>
                    </div>
                    <div class="col-6 p-2" *ngIf="exportOpportunities.compressedAirReductions">
                        <label>Compressed Air Reductions</label>
                        <ul>
                            <li
                                *ngFor="let compressedAirReduction of exportOpportunities.compressedAirReductions; let index = index;">
                                <span
                                    *ngIf="!compressedAirReduction.opportunitySheet || !compressedAirReduction.opportunitySheet.name">
                                    Compressed Air Reduction #{{index+1}}
                                </span>
                                <span
                                    *ngIf="compressedAirReduction.opportunitySheet && compressedAirReduction.opportunitySheet.name">
                                    {{compressedAirReduction.opportunitySheet.name}}
                                </span>
                            </li>
                        </ul>
                    </div>
                    <div class="col-6 p-2" *ngIf="exportOpportunities.compressedAirPressureReductions">
                        <label>Compressed Air Pressure Reductions</label>
                        <ul>
                            <li
                                *ngFor="let compressedAirPressureReduction of exportOpportunities.compressedAirPressureReductions; let index = index;">
                                <span
                                    *ngIf="!compressedAirPressureReduction.opportunitySheet || !compressedAirPressureReduction.opportunitySheet.name">
                                    Compressed Air Pressure Reduction #{{index+1}}
                                </span>
                                <span
                                    *ngIf="compressedAirPressureReduction.opportunitySheet && compressedAirPressureReduction.opportunitySheet.name">
                                    {{compressedAirPressureReduction.opportunitySheet.name}}
                                </span>
                            </li>
                        </ul>
                    </div>
                    <div class="col-6 p-2" *ngIf="exportOpportunities.waterReductions">
                        <label>Water Reductions</label>
                        <ul>
                            <li *ngFor="let waterReduction of exportOpportunities.waterReductions; let index = index;">
                                <span *ngIf="!waterReduction.opportunitySheet || !waterReduction.opportunitySheet.name">
                                    Water Reduction #{{index+1}}
                                </span>
                                <span *ngIf="waterReduction.opportunitySheet && waterReduction.opportunitySheet.name">
                                    {{waterReduction.opportunitySheet.name}}
                                </span>
                            </li>
                        </ul>
                    </div>
                    <div class="col-6 p-2" *ngIf="exportOpportunities.steamReductions">
                        <label>Steam Reductions</label>
                        <ul>
                            <li *ngFor="let steamReduction of exportOpportunities.steamReductions; let index = index;">
                                <span *ngIf="!steamReduction.opportunitySheet || !steamReduction.opportunitySheet.name">
                                    Steam Reduction #{{index+1}}
                                </span>
                                <span *ngIf="steamReduction.opportunitySheet && steamReduction.opportunitySheet.name">
                                    {{steamReduction.opportunitySheet.name}}
                                </span>
                            </li>
                        </ul>
                    </div>
                    <div class="col-6 p-2" *ngIf="exportOpportunities.pipeInsulationReductions">
                        <label>Pipe Insulations</label>
                        <ul>
                            <li
                                *ngFor="let pipeInsulationReduction of exportOpportunities.pipeInsulationReductions; let index = index;">
                                <span
                                    *ngIf="!pipeInsulationReduction.opportunitySheet || !pipeInsulationReduction.opportunitySheet.name">
                                    Pipe Insulation #{{index+1}}
                                </span>
                                <span
                                    *ngIf="pipeInsulationReduction.opportunitySheet && pipeInsulationReduction.opportunitySheet.name">
                                    {{pipeInsulationReduction.opportunitySheet.name}}
                                </span>
                            </li>
                        </ul>
                    </div>
                    <div class="col-6 p-2" *ngIf="exportOpportunities.tankInsulationReductions">
                        <label>Tank Insulations</label>
                        <ul>
                            <li
                                *ngFor="let tankInsulationReduction of exportOpportunities.tankInsulationReductions; let index = index;">
                                <span
                                    *ngIf="!tankInsulationReduction.opportunitySheet || !tankInsulationReduction.opportunitySheet.name">
                                    Tank Insulation #{{index+1}}
                                </span>
                                <span
                                    *ngIf="tankInsulationReduction.opportunitySheet && tankInsulationReduction.opportunitySheet.name">
                                    {{tankInsulationReduction.opportunitySheet.name}}
                                </span>
                            </li>
                        </ul>
                    </div>
                    <div class="col-6 p-2" *ngIf="exportOpportunities.airLeakSurveys">
                        <label>Air Leak Surveys</label>
                        <ul>
                            <li
                                *ngFor="let airLeakSurvey of exportOpportunities.airLeakSurveys; let index = index;">
                                <span
                                    *ngIf="!airLeakSurvey.opportunitySheet || !airLeakSurvey.opportunitySheet.name">
                                    Air Leak Survey #{{index+1}}
                                </span>
                                <span
                                    *ngIf="airLeakSurvey.opportunitySheet && airLeakSurvey.opportunitySheet.name">
                                    {{airLeakSurvey.opportunitySheet.name}}
                                </span>
                            </li>
                        </ul>
                    </div>
                    <div class="col-6 p-2" *ngIf="exportOpportunities.opportunitySheets">
                        <label>Opportunity Sheets</label>
                        <ul>
                            <li
                                *ngFor="let opportunitySheet of exportOpportunities.opportunitySheets; let index = index;">
                                <span *ngIf="!opportunitySheet.name">
                                    Opportunity Sheet #{{index+1}}
                                </span>
                                <span *ngIf="opportunitySheet.name">
                                    {{opportunitySheet.name}}
                                </span>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="modal-footer justify-content-between">
                <button class="btn btn-secondary" (click)="hideExportModal()">Cancel</button>
                <div class="d-flex">
                    <div class="form-group d-flex mr-2">
                        <label for="exportName"> Name your file:</label>
                        <input type="text" class="form-control" id="exportName" [(ngModel)]="exportName">
                    </div>
                    <button class="btn btn-primary ml-2" (click)="exportData()">Export
                        as .json</button>
                </div>
            </div>
        </div>
    </div>
</div>