<div bsModal #exportModal="bs-modal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="exportModalLabel"
    aria-hidden="true" [config]="{backdrop: 'static'}">
    <div class="modal-dialog modal-lg export-modal">
        <div class="modal-content">
            <div class="modal-header">
                Data to be exported
                <button class="close" aria-label="Close" (click)="hideExportModal()">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body pb-0 scroll-item">
                <div class="row no-gutters">
                    <div class="col-6 p-2" *ngIf="exportOpportunities.lightingReplacements">
                        <label>Lighting Replacements</label>
                        <ul>
                            <li
                                *ngFor="let replacement of exportOpportunities.lightingReplacements; let index = index;">
                                <span *ngIf="!replacement.opportunitySheet || !replacement.opportunitySheet.name">
                                    Lighting Replacement #{{index+1}}
                                </span>
                                <span *ngIf="replacement.opportunitySheet && replacement.opportunitySheet.name">
                                    {{replacement.opportunitySheet.name}}
                                </span>
                            </li>
                        </ul>
                    </div>
                    <div class="col-6 p-2" *ngIf="exportOpportunities.replaceExistingMotors">
                        <label>Motor Replacements</label>
                        <ul>
                            <li
                                *ngFor="let replaceExistingMotor of exportOpportunities.replaceExistingMotors; let index = index;">
                                <span
                                    *ngIf="!replaceExistingMotor.opportunitySheet || !replaceExistingMotor.opportunitySheet.name">
                                    Replace Motor #{{index+1}}
                                </span>
                                <span
                                    *ngIf="replaceExistingMotor.opportunitySheet && replaceExistingMotor.opportunitySheet.name">
                                    {{replaceExistingMotor.opportunitySheet.name}}
                                </span>
                            </li>
                        </ul>
                    </div>
                    <div class="col-6 p-2" *ngIf="exportOpportunities.motorDrives">
                        <label>Upgrade Motor Drives</label>
                        <ul>
                            <li *ngFor="let motorDrive of exportOpportunities.motorDrives; let index = index;">
                                <span *ngIf="!motorDrive.opportunitySheet || !motorDrive.opportunitySheet.name">
                                    Motor Drive #{{index+1}}
                                </span>
                                <span *ngIf="motorDrive.opportunitySheet && motorDrive.opportunitySheet.name">
                                    {{motorDrive.opportunitySheet.name}}
                                </span>
                            </li>
                        </ul>
                    </div>
                    <div class="col-6 p-2" *ngIf="exportOpportunities.naturalGasReductions">
                        <label>Natural Gas Reductions</label>
                        <ul>
                            <li
                                *ngFor="let naturalGasReduction of exportOpportunities.naturalGasReductions; let index = index;">
                                <span
                                    *ngIf="!naturalGasReduction.opportunitySheet || !naturalGasReduction.opportunitySheet.name">
                                    Natural Gas Reduction #{{index+1}}
                                </span>
                                <span
                                    *ngIf="naturalGasReduction.opportunitySheet && naturalGasReduction.opportunitySheet.name">
                                    {{naturalGasReduction.opportunitySheet.name}}
                                </span>
                            </li>
                        </ul>
                    </div>
                    <div class="col-6 p-2" *ngIf="exportOpportunities.electricityReductions">
                        <label>Electricity Reductions</label>
                        <ul>
                            <li
                                *ngFor="let electricityReduction of exportOpportunities.electricityReductions; let index = index;">
                                <span
                                    *ngIf="!electricityReduction.opportunitySheet || !electricityReduction.opportunitySheet.name">
                                    Electricity Reduction #{{index+1}}
                                </span>
                                <span
                                    *ngIf="electricityReduction.opportunitySheet && electricityReduction.opportunitySheet.name">
                                    {{electricityReduction.opportunitySheet.name}}
                                </span>
                            </li>
                        </ul>
                    </div>
                    <div class="col-6 p-2" *ngIf="exportOpportunities.compressedAirReductions">
                        <label>Compressed Air Reductions</label>
                        <ul>
                            <li
                                *ngFor="let compressedAirReduction of exportOpportunities.compressedAirReductions; let index = index;">
                                <span
                                    *ngIf="!compressedAirReduction.opportunitySheet || !compressedAirReduction.opportunitySheet.name">
                                    Compressed Air Reduction #{{index+1}}
                                </span>
                                <span
                                    *ngIf="compressedAirReduction.opportunitySheet && compressedAirReduction.opportunitySheet.name">
                                    {{compressedAirReduction.opportunitySheet.name}}
                                </span>
                            </li>
                        </ul>
                    </div>
                    <div class="col-6 p-2" *ngIf="exportOpportunities.compressedAirPressureReductions">
                        <label>Compressed Air Pressure Reductions</label>
                        <ul>
                            <li
                                *ngFor="let compressedAirPressureReduction of exportOpportunities.compressedAirPressureReductions; let index = index;">
                                <span
                                    *ngIf="!compressedAirPressureReduction.opportunitySheet || !compressedAirPressureReduction.opportunitySheet.name">
                                    Compressed Air Pressure Reduction #{{index+1}}
                                </span>
                                <span
                                    *ngIf="compressedAirPressureReduction.opportunitySheet && compressedAirPressureReduction.opportunitySheet.name">
                                    {{compressedAirPressureReduction.opportunitySheet.name}}
                                </span>
                            </li>
                        </ul>
                    </div>
                    <div class="col-6 p-2" *ngIf="exportOpportunities.waterReductions">
                        <label>Water Reductions</label>
                        <ul>
                            <li *ngFor="let waterReduction of exportOpportunities.waterReductions; let index = index;">
                                <span *ngIf="!waterReduction.opportunitySheet || !waterReduction.opportunitySheet.name">
                                    Water Reduction #{{index+1}}
                                </span>
                                <span *ngIf="waterReduction.opportunitySheet && waterReduction.opportunitySheet.name">
                                    {{waterReduction.opportunitySheet.name}}
                                </span>
                            </li>
                        </ul>
                    </div>
                    <div class="col-6 p-2" *ngIf="exportOpportunities.steamReductions">
                        <label>Steam Reductions</label>
                        <ul>
                            <li *ngFor="let steamReduction of exportOpportunities.steamReductions; let index = index;">
                                <span *ngIf="!steamReduction.opportunitySheet || !steamReduction.opportunitySheet.name">
                                    Steam Reduction #{{index+1}}
                                </span>
                                <span *ngIf="steamReduction.opportunitySheet && steamReduction.opportunitySheet.name">
                                    {{steamReduction.opportunitySheet.name}}
                                </span>
                            </li>
                        </ul>
                    </div>
                    <div class="col-6 p-2" *ngIf="exportOpportunities.pipeInsulationReductions">
                        <label>Pipe Insulations</label>
                        <ul>
                            <li
                                *ngFor="let pipeInsulationReduction of exportOpportunities.pipeInsulationReductions; let index = index;">
                                <span
                                    *ngIf="!pipeInsulationReduction.opportunitySheet || !pipeInsulationReduction.opportunitySheet.name">
                                    Pipe Insulation #{{index+1}}
                                </span>
                                <span
                                    *ngIf="pipeInsulationReduction.opportunitySheet && pipeInsulationReduction.opportunitySheet.name">
                                    {{pipeInsulationReduction.opportunitySheet.name}}
                                </span>
                            </li>
                        </ul>
                    </div>
                    <div class="col-6 p-2" *ngIf="exportOpportunities.tankInsulationReductions">
                        <label>Tank Insulations</label>
                        <ul>
                            <li
                                *ngFor="let tankInsulationReduction of exportOpportunities.tankInsulationReductions; let index = index;">
                                <span
                                    *ngIf="!tankInsulationReduction.opportunitySheet || !tankInsulationReduction.opportunitySheet.name">
                                    Tank Insulation #{{index+1}}
                                </span>
                                <span
                                    *ngIf="tankInsulationReduction.opportunitySheet && tankInsulationReduction.opportunitySheet.name">
                                    {{tankInsulationReduction.opportunitySheet.name}}
                                </span>
                            </li>
                        </ul>
                    </div>
                    <div class="col-6 p-2" *ngIf="exportOpportunities.airLeakSurveys">
                        <label>Air Leak Surveys</label>
                        <ul>
                            <li
                                *ngFor="let airLeakSurvey of exportOpportunities.airLeakSurveys; let index = index;">
                                <span
                                    *ngIf="!airLeakSurvey.opportunitySheet || !airLeakSurvey.opportunitySheet.name">
                                    Air Leak Survey #{{index+1}}
                                </span>
                                <span
                                    *ngIf="airLeakSurvey.opportunitySheet && airLeakSurvey.opportunitySheet.name">
                                    {{airLeakSurvey.opportunitySheet.name}}
                                </span>
                            </li>
                        </ul>
                    </div>
                    <div class="col-6 p-2" *ngIf="exportOpportunities.openingLosses">
                        <label>Opening Losses</label>
                        <ul>
                            <li
                                *ngFor="let openingLoss of exportOpportunities.openingLosses; let index = index;">
                                <span
                                    *ngIf="!openingLoss.opportunitySheet || !openingLoss.opportunitySheet.name">
                                    Opening Loss #{{index+1}}
                                </span>
                                <span
                                    *ngIf="openingLoss.opportunitySheet && openingLoss.opportunitySheet.name">
                                    {{openingLoss.opportunitySheet.name}}
                                </span>
                            </li>
                        </ul>
                    </div>
                    <div class="col-6 p-2" *ngIf="exportOpportunities.wallLosses">
                        <label>Wall Losses</label>
                        <ul>
                            <li
                                *ngFor="let wallLoss of exportOpportunities.wallLosses; let index = index;">
                                <span
                                    *ngIf="!wallLoss.opportunitySheet || !wallLoss.opportunitySheet.name">
                                    Wall Loss #{{index+1}}
                                </span>
                                <span
                                    *ngIf="wallLoss.opportunitySheet && wallLoss.opportunitySheet.name">
                                    {{wallLoss.opportunitySheet.name}}
                                </span>
                            </li>
                        </ul>
                    </div>
                    <div class="col-6 p-2" *ngIf="exportOpportunities.leakageLosses">
                        <label>Leakage Losses</label>
                        <ul>
                            <li
                                *ngFor="let leakageLoss of exportOpportunities.leakageLosses; let index = index;">
                                <span
                                    *ngIf="!leakageLoss.opportunitySheet || !leakageLoss.opportunitySheet.name">
                                    Leakage Loss #{{index+1}}
                                </span>
                                <span
                                    *ngIf="leakageLoss.opportunitySheet && leakageLoss.opportunitySheet.name">
                                    {{leakageLoss.opportunitySheet.name}}
                                </span>
                            </li>
                        </ul>
                    </div>
                    <div class="col-6 p-2" *ngIf="exportOpportunities.airHeatingOpportunities">
                        <label>Air Heating Opportunities</label>
                        <ul>
                            <li
                                *ngFor="let airHeating of exportOpportunities.airHeatingOpportunities; let index = index;">
                                <span
                                    *ngIf="!airHeating.opportunitySheet || !airHeating.opportunitySheet.name">
                                    Air Heating #{{index+1}}
                                </span>
                                <span
                                    *ngIf="airHeating.opportunitySheet && airHeating.opportunitySheet.name">
                                    {{airHeating.opportunitySheet.name}}
                                </span>
                            </li>
                        </ul>
                    </div>
                    <div class="col-6 p-2" *ngIf="exportOpportunities.flueGasLosses">
                        <label>Flue Gas Losses</label>
                        <ul>
                            <li
                                *ngFor="let flueGasLoss of exportOpportunities.flueGasLosses; let index = index;">
                                <span
                                    *ngIf="!flueGasLoss.opportunitySheet || !flueGasLoss.opportunitySheet.name">
                                    Flue Gas Loss #{{index+1}}
                                </span>
                                <span
                                    *ngIf="flueGasLoss.opportunitySheet && flueGasLoss.opportunitySheet.name">
                                    {{flueGasLoss.opportunitySheet.name}}
                                </span>
                            </li>
                        </ul>
                    </div>
                    <div class="col-6 p-2" *ngIf="exportOpportunities.wasteHeatReductions">
                        <label>Waste Heat</label>
                        <ul>
                            <li
                                *ngFor="let wasteHeat of exportOpportunities.wasteHeatReductions; let index = index;">
                                <span
                                    *ngIf="!wasteHeat.opportunitySheet || !wasteHeat.opportunitySheet.name">
                                    Waste Heat Reduction #{{index+1}}
                                </span>
                                <span
                                    *ngIf="wasteHeat.opportunitySheet && wasteHeat.opportunitySheet.name">
                                    {{wasteHeat.opportunitySheet.name}}
                                </span>
                            </li>
                        </ul>
                    </div>
                    <div class="col-6 p-2" *ngIf="exportOpportunities.heatCascadingOpportunities">
                        <label>Heat Cascading</label>
                        <ul>
                            <li
                                *ngFor="let heatCascading of exportOpportunities.heatCascadingOpportunities; let index = index;">
                                <span
                                    *ngIf="!heatCascading.opportunitySheet || !heatCascading.opportunitySheet.name">
                                    Heat Cascading #{{index+1}}
                                </span>
                                <span
                                    *ngIf="heatCascading.opportunitySheet && heatCascading.opportunitySheet.name">
                                    {{heatCascading.opportunitySheet.name}}
                                </span>
                            </li>
                        </ul>
                    </div>
                    <div class="col-6 p-2" *ngIf="exportOpportunities.waterHeatingOpportunities">
                        <label>Water Heating </label>
                        <ul>
                            <li
                                *ngFor="let waterHeating of exportOpportunities.waterHeatingOpportunities; let index = index;">
                                <span
                                    *ngIf="!waterHeating.opportunitySheet || !waterHeating.opportunitySheet.name">
                                    Water Heating #{{index+1}}
                                </span>
                                <span
                                    *ngIf="waterHeating.opportunitySheet && waterHeating.opportunitySheet.name">
                                    {{waterHeating.opportunitySheet.name}}
                                </span>
                            </li>
                        </ul>
                    </div>
                    <div class="col-6 p-2" *ngIf="exportOpportunities.boilerBlowdownRateOpportunities">
                        <label>Boiler Blowdown Rate</label>
                        <ul>
                            <li
                                *ngFor="let boiler of exportOpportunities.boilerBlowdownRateOpportunities; let index = index;">
                                <span
                                    *ngIf="!boiler.opportunitySheet || !boiler.opportunitySheet.name">
                                    Boiler Blowdown Rate #{{index+1}}
                                </span>
                                <span
                                    *ngIf="boiler.opportunitySheet && boiler.opportunitySheet.name">
                                    {{boiler.opportunitySheet.name}}
                                </span>
                            </li>
                        </ul>
                    </div>
                    <div class="col-6 p-2" *ngIf="exportOpportunities.coolingTowerMakeupOpportunities">
                        <label>Cooling Tower Makeup Water </label>
                        <ul>
                            <li
                                *ngFor="let coolingTowerMakeup of exportOpportunities.coolingTowerMakupeOpportunities; let index = index;">
                                <span
                                    *ngIf="!coolingTowerMakeup.opportunitySheet || !coolingTowerMakeup.opportunitySheet.name">
                                    Cooling Tower Makeup Water #{{index+1}}
                                </span>
                                <span
                                    *ngIf="coolingTowerMakeup.opportunitySheet && coolingTowerMakeup.opportunitySheet.name">
                                    {{coolingTowerMakeup.opportunitySheet.name}}
                                </span>
                            </li>
                        </ul>
                    </div>
                    <div class="col-6 p-2" *ngIf="exportOpportunities.chillerStagingOpportunities">
                        <label>Chiller Staging </label>
                        <ul>
                            <li
                                *ngFor="let chillerStaging of exportOpportunities.chillerStagingOpportunities; let index = index;">
                                <span
                                    *ngIf="!chillerStaging.opportunitySheet || !chillerStaging.opportunitySheet.name">
                                    Chiller Staging #{{index+1}}
                                </span>
                                <span
                                    *ngIf="chillerStaging.opportunitySheet && chillerStaging.opportunitySheet.name">
                                    {{chillerStaging.opportunitySheet.name}}
                                </span>
                            </li>
                        </ul>
                    </div>
                    <div class="col-6 p-2" *ngIf="exportOpportunities.chillerPerformanceOpportunities">
                        <label>Chiller Performance </label>
                        <ul>
                            <li
                                *ngFor="let chillerPerformance of exportOpportunities.chillerPerformanceOpportunities; let index = index;">
                                <span
                                    *ngIf="!chillerPerformance.opportunitySheet || !chillerPerformance.opportunitySheet.name">
                                    Chiller Performance #{{index+1}}
                                </span>
                                <span
                                    *ngIf="chillerPerformance.opportunitySheet && chillerPerformance.opportunitySheet.name">
                                    {{chillerPerformance.opportunitySheet.name}}
                                </span>
                            </li>
                        </ul>
                    </div>
                    <div class="col-6 p-2" *ngIf="exportOpportunities.coolingTowerFanOpportunities">
                        <label>Cooling Tower Fan </label>
                        <ul>
                            <li
                                *ngFor="let coolingTowerFan of exportOpportunities.coolingTowerFanOpportunities; let index = index;">
                                <span
                                    *ngIf="!coolingTowerFan.opportunitySheet || !coolingTowerFan.opportunitySheet.name">
                                    Cooling Tower Fan #{{index+1}}
                                </span>
                                <span
                                    *ngIf="coolingTowerFan.opportunitySheet && coolingTowerFan.opportunitySheet.name">
                                    {{coolingTowerFan.opportunitySheet.name}}
                                </span>
                            </li>
                        </ul>
                    </div>
                    <div class="col-6 p-2" *ngIf="exportOpportunities.coolingTowerBasinOpportunities">
                        <label>Cooling Tower Basin </label>
                        <ul>
                            <li
                                *ngFor="let coolingTowerBasin of exportOpportunities.coolingTowerBasinOpportunities; let index = index;">
                                <span
                                    *ngIf="!coolingTowerBasin.opportunitySheet || !coolingTowerBasin.opportunitySheet.name">
                                    Cooling Tower Basin #{{index+1}}
                                </span>
                                <span
                                    *ngIf="coolingTowerBasin.opportunitySheet && coolingTowerBasin.opportunitySheet.name">
                                    {{coolingTowerBasin.opportunitySheet.name}}
                                </span>
                            </li>
                        </ul>
                    </div>
                    <div class="col-6 p-2" *ngIf="exportOpportunities.powerFactorCorrectionOpportunities">
                        <label>Power Factor Correction </label>
                        <ul>
                            <li
                                *ngFor="let powerFactorCorrection of exportOpportunities.powerFactorCorrectionOpportunities; let index = index;">
                                <span
                                    *ngIf="!powerFactorCorrection.opportunitySheet || !powerFactorCorrection.opportunitySheet.name">
                                    Power Factor Correction #{{index+1}}
                                </span>
                                <span
                                    *ngIf="powerFactorCorrection.opportunitySheet && powerFactorCorrection.opportunitySheet.name">
                                    {{powerFactorCorrection.opportunitySheet.name}}
                                </span>
                            </li>
                        </ul>
                    </div>
                    <div class="col-6 p-2" *ngIf="exportOpportunities.opportunitySheets">
                        <label>Opportunity Sheets</label>
                        <ul>
                            <li
                                *ngFor="let opportunitySheet of exportOpportunities.opportunitySheets; let index = index;">
                                <span *ngIf="!opportunitySheet.name">
                                    Opportunity Sheet #{{index+1}}
                                </span>
                                <span *ngIf="opportunitySheet.name">
                                    {{opportunitySheet.name}}
                                </span>
                            </li>
                        </ul>
                    </div>
                    <div class="col-6 p-2" *ngIf="exportOpportunities.assessmentOpportunities">
                        <label>Assessment Opportunities</label>
                        <ul>
                            <li
                                *ngFor="let assessmentOpportunity of exportOpportunities.assessmentOpportunities; let index = index;">
                                <span *ngIf="!assessmentOpportunity.name">
                                    Assessment Opportunity #{{index+1}}
                                </span>
                                <span *ngIf="assessmentOpportunity.name">
                                    {{assessmentOpportunity.name}}
                                </span>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="modal-footer justify-content-between">
                <button class="btn btn-secondary" (click)="hideExportModal()">Cancel</button>
                <div class="d-flex">
                    <div class="form-group d-flex mr-2">
                        <label for="exportName"> Name your file:</label>
                        <input type="text" class="form-control" id="exportName" [(ngModel)]="exportName">
                    </div>
                    <button class="btn btn-primary ml-2" (click)="exportData()">Export
                        as .json</button>
                </div>
            </div>
        </div>
    </div>
</div>