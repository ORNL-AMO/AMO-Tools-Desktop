<ng-container *ngIf="emailSentStatus !== 'success'">
  <form [formGroup]="emailDataForm" class="mb-4 px-2">

    <div class="form-group d-flex w-100 mb-3">
      <label class="bold mr-2 w-25" for="emailSender">From</label>
      <div class="input-group">
        <input type="text" formControlName="emailSender" name="emailSender" class="form-control" (input)="save()"
          id="emailSender" />
        <span class="alert-danger pull-right small py-1 px-2"
          *ngIf="emailDataForm.controls.emailSender.invalid && !emailDataForm.controls.emailSender.pristine">
          <span *ngIf="emailDataForm.controls.emailSender.errors.email">Must be a valid email address</span>
        </span>
      </div>
    </div>
    
    <div class="form-group d-flex w-100 mb-3">
      <label class="bold mr-2 w-25" for="emailTo">To</label>
      <div class="input-group">
        <input type="text" formControlName="emailTo" class="form-control" (input)="save()" id="emailTo" />
        <span class="alert-danger pull-right small py-1 px-2"
          *ngIf="emailDataForm.controls.emailTo.invalid && !emailDataForm.controls.emailTo.pristine">
          <span *ngIf="emailDataForm.controls.emailTo.errors.required">Email is required</span>
          <span *ngIf="emailDataForm.controls.emailTo.errors.email">Must be a valid email address</span>
        </span>
      </div>
    </div>

  </form>
</ng-container>

  <div *ngIf="emailSentStatus === 'success'" class="alert-success small mx-2 px-3 py-2">
    An email has been sent to <span class="bold">{{emailDataForm.controls.emailTo.value}}</span>. If the email is not received, please check the spam folder.
  </div>
  
  <div *ngIf="emailSentStatus === 'error'" class="alert-danger small mx-2 px-3 py-2">
    <span>An error has occured. Please verify your network connection and try again.</span>
  </div>
  
  <div *ngIf="emailSentStatus === 'content-too-large'" class="alert-danger small mx-2 px-3 py-2">
    <span>This item is too large to send as an email attachment. Please try sharing using the export feature.</span>
  </div>

  <ng-container *ngIf="emailSentStatus === 'sending'">
    <div class="spinner-overlay align-items-center w-100 text-center">
      <div class="spinner mt-2 w-100">
          <div class="bounce1"></div>
          <div class="bounce2"></div>
          <div class="bounce3"></div>
      </div>
      <div class="importing-text w-100">Sending Email...</div>
  </div>
  </ng-container>

<ng-container *ngIf="!['success', 'sending'].includes(emailSentStatus)">
  <div class="alert-info small mx-2 px-3 py-2">
    Emails are delivered from sender <span class="bold">no-reply-measur&#64;ornl.gov</span>
  </div>

  <div class="card m-2">
      <div class="card-header preview" (click)="togglePreview()">
      Email Preview
      <span class="pull-right" *ngIf="!showPreview"><i class="fa fa-chevron-up"></i></span>
    <span class="pull-right" *ngIf="showPreview"><i class="fa fa-chevron-down"></i></span>
    </div>
    <div class="card-body small" *ngIf="showPreview">
      <p>
        This email contains an attachment of exported data from the MEASUR application, generated by
        {{emailSender}}.
      </p>
      <hr>
      <span class="h6">More Information</span>

      <div>
        Manufacturing Energy Assessment Software for Utility Reduction (MEASUR)
        <br>
        <a target="_blank" href="https://www.energy.gov/eere/iedo/measur"
          alt="https://www.energy.gov/eere/iedo/measur">https://www.energy.gov/eere/iedo/measur</a>
      </div>

      <div>
        MEASUR on the web:
        <br>
        <a target="_blank" href="https://measur.ornl.gov" alt="https://measur.ornl.gov">https://measur.ornl.gov</a>
      </div>
    </div>
  </div>
</ng-container>
